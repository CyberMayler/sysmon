<!-- To find the fields to be filtered, just run the command below and add the lines below by type of event. -->
<!-- sudo tail -f /var/log/syslog | sudo /opt/sysmon/sysmonLogView -->
<!--Below is an example of data types that can be filtered to not appear in the logs. -->
<!-- https://github.com/SwiftOnSecurity/sysmon-config/blob/master/sysmonconfig-export.xml -->
<!-- Event ID 1 == ProcessCreate. Log all newly created processes -->
<Sysmon schemaversion="4.70">
        <EventFiltering>
                <!-- Event ID 1 == ProcessCreate. Log all newly created processes -->
                <RuleGroup name="" groupRelation="or">
                        <ProcessCreate onmatch="exclude">
                                <CommandLine condition="is">sleep 1</CommandLine>
                                <CommandLine condition="is">df -l</CommandLine>
                                <Image condition="image">/usr/bin/head</Image>
                                <Image condition="image">/usr/bin/tail</Image>
                                <Image condition="image">/usr/bin/who</Image>
                                <Image condition="image">/usr/libexec/docker/docker-init</Image>
                                <Image condition="image">/usr/bin/runc</Image>
                                <Image condition="image">/usr/bin/sed</Image>
                                <Image condition="image">/usr/bin/sort</Image>
                                <Image condition="image">/usr/bin/df</Image>
                                <Image condition="image">/usr/bin/who</Image>
                        </ProcessCreate>
                </RuleGroup>

                <!-- Event ID 3 == ProcessCreate. Log all newly created pro -->
                <RuleGroup name="" groupRelation="or">
                        <NetworkConnect onmatch="exclude">
                                <Image condition="image">/var/ossec/bin/wazuh-agentd</Image>
                        </NetworkConnect>
                </RuleGroup>

                  <!-- Event ID 5 == ProcessTerminated. Log all newly terminated processes -->
                <RuleGroup name="" groupRelation="or">
                        <ProcessTerminate onmatch="exclude">
                                <Image condition="image">/usr/bin/head</Image>
                                <Image condition="image">/usr/bin/tail</Image>
                                <Image condition="image">/usr/bin/who</Image>
                                <Image condition="image">/usr/bin/df</Image>
                                <Image condition="image">/usr/bin/sleep</Image>
                                <Image condition="not_equal">&lt;unknown process&gt;</Image>
                                <Image condition="image">/usr/bin/runc</Image>
                                <Image condition="image">/usr/bin/sed</Image>
                                <Image condition="image">/usr/bin/sort</Image>
                                <Image condition="image">/usr/libexec/docker/docker-init</Image>
                                
                        </ProcessTerminate >
                </RuleGroup>

                  <!-- Event ID 9 == RawAccessRead. Log all raw access read -->
                <RuleGroup name="" groupRelation="or">
                        <RawAccessRead onmatch="exclude"/>
                </RuleGroup>

                  <!-- Event ID 10 == ProcessAccess. Log all open process operations -->
                <RuleGroup name="" groupRelation="or">
                        <ProcessAccess onmatch="exclude"/>
                </RuleGroup>

                  <!-- Event ID 11 == FileCreate. Log every file creation -->
                <RuleGroup name="" groupRelation="or">
                        <FileCreate onmatch="exclude">
                                <Image condition="image">/var/ossec/bin/wazuh-agentd</Image>
                                <Image condition="image">/usr/sbin/rsyslogd</Image>
                                <Image condition="image">/usr/lib/systemd/systemd-logind</Image>
                                <Image condition="image">/usr/lib/systemd/systemd-journald</Image>
                                <Image condition="image">/usr/lib/systemd/systemd</Image>
                                <Image condition="image">/usr/bin/mandb</Image>
                                <Image condition="image">/usr/bin/python3.9</Image>
                                <Image condition="image">/usr/sbin/ldconfig</Image>
                        </FileCreate>
                </RuleGroup>

                  <!-- Event ID 23 == FileDelete. Log all files being deleted -->
                <RuleGroup name="" groupRelation="or">
                        <FileDelete onmatch="exclude"/>
                </RuleGroup>
        </EventFiltering>
</Sysmon>

